{% import "@SyliusShop/Common/Macro/money.html.twig" as money %}

{% set itemsSubtotal = sylius_order_items_subtotal(cart) %}
{% set taxIncluded = sylius_order_tax_included(cart) %}
{% set taxExcluded = sylius_order_tax_excluded(cart) %}

<div class="totals card mb-3">
    {{ sonata_block_render_event('sylius.shop.cart.summary.totals', {'cart': cart}) }}

    <div class="d-flex flex-column py-3 px-4 col-11 col-md-10 col-lg-12 mx-auto">
        <div class="d-flex justify-content-between">
            <span>{{ 'sylius.ui.items_total'|trans }}</span>
            <span>{{ money.convertAndFormat(itemsSubtotal - taxIncluded) }}</span>
        </div>

        <div class="d-flex justify-content-between">
            <span>{{ 'sylius.ui.tva_20'|trans }}</span>
            {% if not taxIncluded and not taxExcluded %}
                <span>{{ money.convertAndFormat(0) }}</span>
            {% endif %}
            {% if taxExcluded %}
                <span>{{ money.convertAndFormat(taxExcluded) }}</span>
            {% endif %}
            {% if taxIncluded %}
                <span>{{ money.convertAndFormat(taxIncluded) }}</span>
            {% endif %}
        </div>

        <div class="d-flex justify-content-between mt-3">
            <span>
                {{ 'sylius.ui.global_amount'|trans }}<br>
                <small>{{ 'sylius.ui.without_shipping'|trans }}</small>
            </span>
            <span>{{ money.convertAndFormat(itemsSubtotal) }}</span>
        </div>

        <div class="total-separator w-75 mx-auto mt-3 mb-2"></div>

        <div class="d-flex justify-content-between">
            <span class="col-9 p-0">
                <select class="form-control mb-1">
                    <option value="1">{{ 'sylius.ui.france_shipping'|trans }}</option>
                    <option value="1">{{ 'sylius.ui.europe_shipping'|trans }}</option>
                    <option value="1">{{ 'sylius.ui.international_shipping'|trans }}</option>
                </select>
            </span>
            <span class="col"></span>
        </div>

        <div class="d-flex justify-content-between">
            <span class="col-9 p-0">
                <select class="form-control my-2">
                    <option value="1">{{ 'Livraison standard' }}</option>
                    <option value="1">{{ 'Livraison Express (Chronopost)' }}</option>
                    <option value="1">{{ 'Livraison en point relais' }}</option>
                </select>
            </span>
            <span class="col-3 p-0 d-flex align-items-center justify-content-end">
                {% if cart.shippingTotal > 0 %}
                    {% if cart.getAdjustmentsTotal('shipping') > cart.shippingTotal %}
                        <small><s>{{ money.convertAndFormat(cart.getAdjustmentsTotal('shipping')) }}</s></small>
                    {% endif %}
                    {{ money.convertAndFormat(cart.shippingTotal) }}
                {% else %}
                    <strong class="text-uppercase">{{ 'sylius.ui.free_shipping'|trans }}</strong>
                {% endif %}
            </span>
        </div>

        <div>
            <span class="text-muted">Livraison standard 5,90€</span> (offerte dès 80€)<br>
            <span class="text-muted">Livraison express 14,90€</span> (offerte dès 300€)<br>
        </div>

        <div class="total-separator w-75 mx-auto mt-3 mb-2"></div>

        <div class="d-flex flex-column">
            <span class="text-muted mb-2">{{ 'Les codes promo ne peuvent pas être combinés' }}</span>
            <div class="coupon-input input-group mb-2 mr-sm-2">
                <input type="text" placeholder="Ajouter un code promo" class="coupon-code form-control w-100" />
                <div class="input-group-append">
                    <button class="btn input-group-text coupon-code-btn"><i class="fas fa-long-arrow-alt-right"></i></button>
                </div>
            </div>
            <span class="coupon-error px-2"></span>
        </div>

        {% if cart.orderPromotionTotal %}
        <div class="d-flex justify-content-between">
            <span>{{ 'sylius.ui.discount'|trans }}</span>
            <span>{{ money.convertAndFormat(cart.orderPromotionTotal) }}</span>
        </div>
        {% endif %}

        <div class="total-separator w-75 mx-auto mt-3 mb-2"></div>
        

        <div class="d-flex justify-content-between mt-3">
            <span>
                <strong>{{ 'sylius.ui.order_total'|trans }}</strong><br>
                <span>{{ 'sylius.ui.ttc'|trans }}</span>
            </span>
            <span><strong>{{ money.convertAndFormat(cart.total) }}</strong></span>
        </div>

        {% include '@SyliusShop/Cart/Summary/_checkout.html.twig' %}
    </div>
</div>
